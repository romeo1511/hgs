<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√≠nh C√¥ng Nh√¢n Vi√™n</title>
    <!-- Google Fonts for Premium Feel -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- SheetJS for Excel Parsing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="background-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <div class="glass-container">
        <header>
            <h1>Qu·∫£n L√Ω Gi·ªù C√¥ng</h1>
            <p class="subtitle">H·ªá th·ªëng t√≠nh to√°n t·ª± ƒë·ªông t·ª´ t·ªáp Excel</p>
        </header>

        <main>
            <!-- Upload Section -->
            <section class="upload-section">
                <div class="file-drop-area" id="drop-area">
                    <span class="icon">üìÇ</span>
                    <p>K√©o th·∫£ file Excel v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</p>
                    <input type="file" id="file-input" accept=".xlsx, .xls">
                </div>
                <div id="file-info" class="hidden">
                    <p>ƒê√£ ch·ªçn: <span id="filename"></span></p>
                </div>
            </section>

            <!-- Control Panel (Hidden initially) -->
            <section id="control-panel" class="hidden fade-in">
                <!-- Mode Toggle -->
                <div class="mode-toggle">
                    <button class="mode-btn active" data-mode="sheet">T·ªïng h·ª£p c√¥ng</button>
                    <button class="mode-btn" data-mode="day">Xem theo Ng√†y</button>
                    <button class="mode-btn" data-mode="availability">T√¨m NV R·∫£nh</button>
                </div>

                <!-- Attendance Summary Mode (Formerly Sheet View) -->
                <div id="sheet-mode-controls" class="mode-controls">
                    <div class="input-group" style="display: none;">
                        <label for="sheet-select">Ch·ªçn Sheet d·ªØ li·ªáu</label>
                        <select id="sheet-select">
                            <option value="">-- Ch·ªçn Sheet --</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="staff-search">T√¨m Nh√¢n vi√™n (T√≠nh c√¥ng tu·∫ßn)</label>
                        <div class="searchable-select">
                            <input type="text" id="staff-search" placeholder="Nh·∫≠p t√™n nh√¢n vi√™n..." autocomplete="off">
                            <div id="staff-results" class="search-results hidden"></div>
                            <select id="staff-select" class="hidden"></select>
                        </div>
                    </div>
                </div>

                <!-- Day View Mode (New) -->
                <div id="day-mode-controls" class="mode-controls hidden">
                    <div class="input-group">
                        <label for="day-select">Ch·ªçn Ng√†y trong tu·∫ßn</label>
                        <select id="day-select">
                            <option value="">-- Ch·ªçn Ng√†y --</option>
                            <option value="MON">Th·ª© 2 (MON)</option>
                            <option value="TUE">Th·ª© 3 (TUE)</option>
                            <option value="WED">Th·ª© 4 (WED)</option>
                            <option value="THU">Th·ª© 5 (THU)</option>
                            <option value="FRI">Th·ª© 6 (FRI)</option>
                            <option value="SAT">Th·ª© 7 (SAT)</option>
                            <option value="SUN">Ch·ªß nh·∫≠t (SUN)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="day-staff-search">Ch·ªçn Nh√¢n vi√™n</label>
                        <div class="searchable-select">
                            <input type="text" id="day-staff-search" placeholder="Nh·∫≠p t√™n nh√¢n vi√™n..."
                                autocomplete="off" disabled>
                            <div id="day-staff-results" class="search-results hidden"></div>
                            <select id="day-staff-select" class="hidden" disabled></select>
                        </div>
                    </div>
                </div>

                <!-- Availability Search Mode (New) -->
                <div id="availability-mode-controls" class="mode-controls hidden">
                    <div class="input-group">
                        <label for="avail-day-select">Ch·ªçn Ng√†y trong tu·∫ßn</label>
                        <select id="avail-day-select">
                            <option value="">-- Ch·ªçn Ng√†y --</option>
                            <option value="MON">Th·ª© 2 (MON)</option>
                            <option value="TUE">Th·ª© 3 (TUE)</option>
                            <option value="WED">Th·ª© 4 (WED)</option>
                            <option value="THU">Th·ª© 5 (THU)</option>
                            <option value="FRI">Th·ª© 6 (FRI)</option>
                            <option value="SAT">Th·ª© 7 (SAT)</option>
                            <option value="SUN">Ch·ªß nh·∫≠t (SUN)</option>
                        </select>
                    </div>
                    <div class="row-inputs" style="display: flex; gap: 10px;">
                        <div class="input-group" style="flex: 1;">
                            <label for="avail-time-start">T·ª´ gi·ªù</label>
                            <input type="time" id="avail-time-start" value="08:00">
                        </div>
                        <div class="input-group" style="flex: 1;">
                            <label for="avail-time-end">ƒê·∫øn gi·ªù</label>
                            <input type="time" id="avail-time-end" value="12:00">
                        </div>
                    </div>
                    <button id="search-avail-btn" class="upload-btn" style="margin-top: 10px; width: 100%;">
                        <span>üîç T√¨m nh√¢n vi√™n r·∫£nh</span>
                    </button>
                </div>
            </section>

            <!-- Results Section -->
            <section id="result-section" class="hidden fade-in">
                <!-- Attendance Summary (Only for QT Sheets) -->
                <div id="attendance-view" class="hidden">
                    <div class="card summary-card">
                        <h2>T·ªïng Gi·ªù L√†m Vi·ªác</h2>
                        <div class="total-hours" id="total-hours">0</div>
                        <div class="total-days">T·ªïng s·ªë ca: <span id="total-shifts">0</span></div>
                    </div>

                    <div class="card details-card">
                        <h3>Chi ti·∫øt ch·∫•m c√¥ng tu·∫ßn</h3>
                        <div class="table-wrapper">
                            <table id="details-table">
                                <thead>
                                    <tr>
                                        <th>Ng√†y</th>
                                        <th>Ca tr·ª±c/M√£</th>
                                        <th>Gi·ªù v√†o/Chi ti·∫øt</th>
                                        <th>Gi·ªù ra</th>
                                        <th>S·ªë gi·ªù</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Flight Schedule View (Only for Daily Sheets) -->
                <div id="flight-view" class="hidden">
                    <div class="card details-card">
                        <h3>L·ªãch Bay Ph·ª•c V·ª•</h3>
                        <div class="table-wrapper">
                            <table id="flights-table">
                                <thead>
                                    <tr>
                                        <th>S·ªë hi·ªáu (Flight)</th>
                                        <th>Gi·ªù (ETD)</th>
                                        <th>V·ªã tr√≠ (Position)</th>
                                        <th>C·ª≠a (Gate)</th> <!-- Optional context -->
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Combined Day View (Shift + Flights) -->
                <div id="day-view" class="hidden">
                    <!-- Shift Info Card -->
                    <div class="card shift-info-card">
                        <h2>üìÖ Th√¥ng tin ca l√†m vi·ªác</h2>
                        <div id="shift-info-content">
                            <div class="shift-badge" id="shift-badge">--</div>
                            <div class="shift-time" id="shift-time">--</div>
                            <div class="shift-duration" id="shift-duration">--</div>
                        </div>
                    </div>

                    <!-- Flight Timeline -->
                    <div class="card flight-timeline-card">
                        <h3>‚úàÔ∏è L·ªãch bay ph·ª•c v·ª• trong ng√†y</h3>
                        <div id="flight-timeline">
                            <!-- Timeline items will be inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Availability Results (New) -->
                <div id="availability-view" class="hidden">
                    <div class="card">
                        <div class="card-header">
                            <h2 id="avail-results-title">Danh s√°ch nh√¢n vi√™n r·∫£nh</h2>
                        </div>
                        <div class="card-content">
                            <div id="avail-list" class="avail-grid">
                                <!-- Available staff cards will be injected here -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Debug/Inspector Section -->
            <section id="inspector-section" class="hidden">
                <details>
                    <summary>üõ† Data Inspector (D√†nh cho K·ªπ thu·∫≠t)</summary>
                    <pre id="debug-output"></pre>
                </details>
            </section>
        </main>
    </div>

    <script src="app.js"></script>
</body>

</html>